<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Get started with funbiogeo • funbiogeo</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get started with funbiogeo">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">funbiogeo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/funbiogeo.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/diagnostic-plots.html">Diagnostic Plots in funbiogeo</a></li>
    <li><a class="dropdown-item" href="../articles/long-format.html">Formatting your data</a></li>
    <li><a class="dropdown-item" href="../articles/upscaling.html">Upscaling your data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/frbcesab/funbiogeo/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Get started with funbiogeo</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/frbcesab/funbiogeo/blob/main/vignettes/funbiogeo.Rmd" class="external-link"><code>vignettes/funbiogeo.Rmd</code></a></small>
      <div class="d-none name"><code>funbiogeo.Rmd</code></div>
    </div>

    
    
<p>The aim of the <code>funbiogeo</code> package is to help users
streamline the workflows in <strong>fun</strong>ctional
<strong>biogeo</strong>graphy <span class="citation">(Violle et al.
2014)</span>. It helps filter sites, species, and traits based on their
trait coverages. It also provide default diagnostic plots and standard
tables summarizing input data. This vignette aims to be an introduction
to the most commonly used functions.</p>
<p>The vignette is a worked through real world example of a functional
biogeography workflow using the internal dataset provided in
<code>funbiogeo</code> and derived from the WOODIV database <span class="citation">(Monnet et al. 2021)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://frbcesab.github.io/funbiogeo/">"funbiogeo"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://r-spatial.github.io/sf/" class="external-link">"sf"</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Linking to GEOS 3.12.1, GDAL 3.8.4, PROJ 9.4.0; sf_use_s2() is TRUE</span></span></code></pre></div>
<div class="section level2">
<h2 id="provided-data">Provided data<a class="anchor" aria-label="anchor" href="#provided-data"></a>
</h2>
<p>We are interested in mapping the functional traits of 26 Rosacean
tree species of Western European Mediterranean regions.</p>
<p>The functions in <code>funbiogeo</code> mostly leverage three
different objects:</p>
<ul>
<li>the <strong>species x traits</strong> <code>data.frame</code>, which
describes the traits (in columns) of the species (in rows)
(<code>species_traits</code> dataset in <code>funbiogeo</code>);</li>
<li>the <strong>site x species</strong> <code>data.frame</code>, which
describes the presence/absence, the abundance, or the cover of species
(in columns) across sites (in rows) (<code>site_species</code> dataset
in <code>funbiogeo</code>);</li>
<li>the <strong>site x locations</strong> object, which describes the
physical location of sites through an <code>sf</code> object
(<code>site_locations</code> dataset in <code>funbiogeo</code>).</li>
</ul>
<p>You can load the example data using the
<code>data(..., package = "funbiogeo")</code> call:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"woodiv_site_species"</span>, package <span class="op">=</span> <span class="st">"funbiogeo"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"woodiv_locations"</span>, package <span class="op">=</span> <span class="st">"funbiogeo"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"woodiv_traits"</span>, package <span class="op">=</span> <span class="st">"funbiogeo"</span><span class="op">)</span></span></code></pre></div>
<p>In the following sections we’ll describe in detail these three
provided datasets in the package.</p>
<div class="section level3">
<h3 id="species-x-traits">Species x Traits<a class="anchor" aria-label="anchor" href="#species-x-traits"></a>
</h3>
<p>This object contains traits values for multiple traits (as columns)
for studied species (as rows). It should be a <code>data.frame</code>.
The first column should contain species names and the other columns
contain trait values.</p>
<p>Note that we’ll be talking about <strong>species</strong> throughout
this vignette and in the arguments of <code>funbiogeo</code>, but the
package doesn’t make any assumption on the biological level. It can be
individuals, populations, strains, species, genera, families, etc. The
important fact is that you should have trait data for the level at which
you want to work.</p>
<p>Let’s examine the <code>species_traits</code> data included in the
package:</p>
<table class="table">
<caption>Format of species x traits dataset</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="center">species</th>
<th align="right">plant_height</th>
<th align="right">seed_mass</th>
<th align="right">sla</th>
<th align="right">wood_density</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="center">AALB</td>
<td align="right">49.64162</td>
<td align="right">67.86692</td>
<td align="right">7.483978</td>
<td align="right">0.4490821</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="center">ACEP</td>
<td align="right">25.87500</td>
<td align="right">64.70375</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">4</td>
<td align="center">ANEB</td>
<td align="right">15.00000</td>
<td align="right">NA</td>
<td align="right">3.420603</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">5</td>
<td align="center">APIN</td>
<td align="right">27.33333</td>
<td align="right">55.52000</td>
<td align="right">3.420603</td>
<td align="right">0.4586508</td>
</tr>
</tbody>
</table>
<p>The first column <strong><code>"species"</code></strong> contains
species names, while the next four columns contain different traits for
all species.</p>
<p>Let’s look at a summary of the trait dataset:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">woodiv_traits</span><span class="op">)</span></span>
<span><span class="co">#&gt;    species           plant_height      seed_mass            sla        </span></span>
<span><span class="co">#&gt;  Length:24          Min.   : 1.368   Min.   :  7.608   Min.   : 0.508  </span></span>
<span><span class="co">#&gt;  Class :character   1st Qu.: 8.776   1st Qu.: 14.926   1st Qu.: 3.421  </span></span>
<span><span class="co">#&gt;  Mode  :character   Median :16.908   Median : 30.188   Median : 4.365  </span></span>
<span><span class="co">#&gt;                     Mean   :18.779   Mean   : 62.245   Mean   : 4.773  </span></span>
<span><span class="co">#&gt;                     3rd Qu.:25.531   3rd Qu.: 57.558   3rd Qu.: 5.824  </span></span>
<span><span class="co">#&gt;                     Max.   :49.642   Max.   :626.189   Max.   :10.600  </span></span>
<span><span class="co">#&gt;                                      NA's   :1         NA's   :7       </span></span>
<span><span class="co">#&gt;   wood_density   </span></span>
<span><span class="co">#&gt;  Min.   :0.2796  </span></span>
<span><span class="co">#&gt;  1st Qu.:0.4500  </span></span>
<span><span class="co">#&gt;  Median :0.4642  </span></span>
<span><span class="co">#&gt;  Mean   :0.4948  </span></span>
<span><span class="co">#&gt;  3rd Qu.:0.5300  </span></span>
<span><span class="co">#&gt;  Max.   :0.6488  </span></span>
<span><span class="co">#&gt;  NA's   :7</span></span></code></pre></div>
<p>Note that to use your own species by traits <code>data.frame</code>,
it should follow similar structure with the first column being named
<strong><code>"species"</code></strong> and the other ones containing
traits.</p>
</div>
<div class="section level3">
<h3 id="site-x-species">Site x Species<a class="anchor" aria-label="anchor" href="#site-x-species"></a>
</h3>
<p>This object contains species occurrences/abundance/coverage at
sites<br>
of the study area. It is a <code>data.frame</code>. The first column,
<strong><code>"site"</code></strong>, contains site names while the
other columns contains the abundance of each species across sites.</p>
<p>Note that here we are talking about sites in an abstract way. These
can be plots, assemblages, of whatever collections of species you’re
interested in.</p>
<p>The package <code>funbiogeo</code> comes with the example dataset on
Rosacean tree species of Western European Mediterranean regions
<code>site_species</code>. Let’s look at it:</p>
<table class="table">
<caption>Format of site x species dataset</caption>
<thead><tr class="header">
<th align="center">site</th>
<th align="center">AALB</th>
<th align="center">ACEP</th>
<th align="center">APIN</th>
<th align="center">CLIB</th>
<th align="center">CSEM</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">41152325</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">40852325</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">40852345</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">42552105</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">41152315</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">37452365</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">36952225</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">37152185</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">39852335</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">39652375</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p>The example dataset contains the occurrence of the 26 Rosaceae tree
species across 4,723 sites (grid cells of 10 x 10 km resolution).</p>
<p>Note that to use your own site by species <code>data.frame</code>, it
should follow similar structure with the first column being named
<strong><code>"sites"</code></strong> and the other ones containing
presence information of species across sites.</p>
</div>
<div class="section level3">
<h3 id="site-x-locations">Site x Locations<a class="anchor" aria-label="anchor" href="#site-x-locations"></a>
</h3>
<p>This object contains the geographical location of the sites. It
should be an <code>sf</code> object from the <a href="https://cran.r-project.org/package=sf" class="external-link"><code>sf</code>
package</a>. These are spatial R objects that describe geographical
locations. The sites can have arbitrary shapes: points, regular
polygons, irregular polygons, or even line transects! To make sure that
your data is well plotted you should specify the Coordinate Reference
System (CRS) of this object.</p>
<p>The package <code>funbiogeo</code> comes with the example dataset
<code>site_locations</code> defining the location of the 4,723 sites
(grid cells of 10 x 10 km resolution) as polygons. It contains the names
of the site in its first column
<strong><code>"site"</code></strong>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">woodiv_locations</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 6 features and 2 fields</span></span>
<span><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 2630000 ymin: 1750000 xmax: 2650000 ymax: 1970000</span></span>
<span><span class="co">#&gt; Projected CRS: ETRS89-extended / LAEA Europe</span></span>
<span><span class="co">#&gt;       site  country                       geometry</span></span>
<span><span class="co">#&gt; 1 26351755 Portugal POLYGON ((2630000 1750000, ...</span></span>
<span><span class="co">#&gt; 2 26351765 Portugal POLYGON ((2630000 1760000, ...</span></span>
<span><span class="co">#&gt; 4 26351955 Portugal POLYGON ((2630000 1950000, ...</span></span>
<span><span class="co">#&gt; 5 26351965 Portugal POLYGON ((2630000 1960000, ...</span></span>
<span><span class="co">#&gt; 6 26451755 Portugal POLYGON ((2640000 1750000, ...</span></span>
<span><span class="co">#&gt; 7 26451765 Portugal POLYGON ((2640000 1760000, ...</span></span></code></pre></div>
<p>Note that to use your own site locations object, it should follow
similar structure, being an <code>sf</code> object with the first column
being named <strong><code>"sites"</code></strong>.</p>
</div>
</div>
<div class="section level2">
<h2 id="visualizing-the-data-diagnostic-plots">Visualizing the data (diagnostic plots)<a class="anchor" aria-label="anchor" href="#visualizing-the-data-diagnostic-plots"></a>
</h2>
<p><code>funbiogeo</code> provides many functions to display the data to
help the user select specific traits, species, and/or sites. We are
going to detail some of them in this section (see the full list in the
<a href="diagnostic-plots.Rmd">diagnostic plots vignette</a>. We call
them <em>diagnostic plots</em> because they help us to have an overview
of our dataset <strong>prior</strong> to the analyses.</p>
<div class="section level3">
<h3 id="trait-completeness-per-species">Trait completeness per species<a class="anchor" aria-label="anchor" href="#trait-completeness-per-species"></a>
</h3>
<p>A first way to visualize our <code>data.frame</code> is to look at
the proportion of species with non-missing traits using the
<code><a href="../reference/fb_plot_number_species_by_trait.html">fb_plot_number_species_by_trait()</a></code> function. It takes the
species by trait <code>data.frame</code> as input.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fb_plot_number_species_by_trait.html">fb_plot_number_species_by_trait</a></span><span class="op">(</span><span class="va">woodiv_traits</span><span class="op">)</span></span></code></pre></div>
<p><img src="funbiogeo_files/figure-html/fig-plot-sp-by-trait-1.png" width="100%"></p>
<p>This plot shows us the number of species (along the x-axis) in
function of the trait name (along the y-axis). The number of concerned
species is shown at the bottom of the plot while the corresponding
proportion of species (compared to all the species included in the trait
dataset) is indicated as a secondary x-axis at the top. The proportion
of species concerned is shown at the right of each point. <del>For
example, in our example dataset, 82.6% species have a non-NA adult body
mass</del>.</p>
<p>The function also includes a way to provide a target proportion of
species as the second argument. It will display the proportion as a dark
red dashed line.</p>
<p>For example, if we want to visualize which traits cover more than 75%
of the species:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fb_plot_number_species_by_trait.html">fb_plot_number_species_by_trait</a></span><span class="op">(</span><span class="va">woodiv_traits</span>, threshold_species_proportion <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span></span></code></pre></div>
<p><img src="funbiogeo_files/figure-html/fig-plot-sp-by-trait-prop-1.png" width="100%"></p>
<p>The top number shows the corresponding number of species.</p>
</div>
<div class="section level3">
<h3 id="number-of-traits-per-species">Number of Traits per Species<a class="anchor" aria-label="anchor" href="#number-of-traits-per-species"></a>
</h3>
<p>Another way to filter the data would be to select certain species
that have at least a certain number of traits. This can be visualized
using the <code><a href="../reference/fb_plot_number_traits_by_species.html">fb_plot_number_traits_by_species()</a></code> function.
Similarly to the above-mentioned function, it takes the species x traits
<code>data.frame</code> as the first argument:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fb_plot_number_traits_by_species.html">fb_plot_number_traits_by_species</a></span><span class="op">(</span><span class="va">woodiv_traits</span><span class="op">)</span></span></code></pre></div>
<p><img src="funbiogeo_files/figure-html/fig-plot-trait-by-sp-1.png" width="100%"></p>
<p>The plot shows the number (bottom x-axis) and the proportion (top
x-axis) of species covered by a specific number of traits (0 to 4 in our
example).</p>
</div>
</div>
<div class="section level2">
<h2 id="filtering-the-data">Filtering the data<a class="anchor" aria-label="anchor" href="#filtering-the-data"></a>
</h2>
<p>Now that we displayed the diagnostic plots, we can decide thresholds
and filter our data for our following analyses.</p>
<div class="section level3">
<h3 id="filter-trait-by-species-coverage">Filter trait by species coverage<a class="anchor" aria-label="anchor" href="#filter-trait-by-species-coverage"></a>
</h3>
<p>We want to select the traits that are available for at least 75% of
the species. To do so we can use the
<code><a href="../reference/fb_filter_traits_by_species_coverage.html">fb_filter_traits_by_species_coverage()</a></code> function. The
function takes the species by traits <code>data.frame</code> and outputs
the same dataset but with the traits filtered (so with less columns).
The second argument <code>threshold_species_proportion</code> is the
threshold proportion of species covered:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Initial dimension of the input data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">woodiv_traits</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 24  5</span></span>
<span></span>
<span><span class="co"># Filter traits </span></span>
<span><span class="va">red_sp_traits</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fb_filter_traits_by_species_coverage.html">fb_filter_traits_by_species_coverage</a></span><span class="op">(</span></span>
<span>  <span class="va">woodiv_traits</span>, threshold_species_proportion <span class="op">=</span>  <span class="fl">0.75</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">red_sp_traits</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 24  3</span></span>
<span></span>
<span><span class="co"># The reduced data set now has fewer trait columns</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">red_sp_traits</span><span class="op">)</span></span>
<span><span class="co">#&gt;   species plant_height seed_mass</span></span>
<span><span class="co">#&gt; 1    AALB     49.64162 67.866923</span></span>
<span><span class="co">#&gt; 3    ACEP     25.87500 64.703750</span></span>
<span><span class="co">#&gt; 4    ANEB     15.00000        NA</span></span>
<span><span class="co">#&gt; 5    APIN     27.33333 55.520000</span></span>
<span><span class="co">#&gt; 6    CLIB     35.63636 86.872600</span></span>
<span><span class="co">#&gt; 7    CSEM     24.69231  7.608125</span></span></code></pre></div>
<p>The function outputs a filtered species-traits dataset retaining only
traits covering at least 75% of the species. <del>In the end this keep
two traits: body mass and litter size</del>.</p>
</div>
<div class="section level3">
<h3 id="filter-species-by-trait-coverage">Filter species by trait coverage<a class="anchor" aria-label="anchor" href="#filter-species-by-trait-coverage"></a>
</h3>
<p>Similarly you could filter species by their trait coverage. For
example we would like to make sure that the species we filtered
previously so that they show at least one of the two traits selected
above and thus exclude species for which neither of the traits are
available. We can use the function
<code><a href="../reference/fb_filter_species_by_trait_coverage.html">fb_filter_species_by_trait_coverage()</a></code> with the species x
traits <code>data.frame</code> as the first argument and the second
argument the proportion of traits covered by species.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filter species with at least 50% of included (two traits)</span></span>
<span><span class="co"># at least one trait</span></span>
<span><span class="va">red_sp_traits_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fb_filter_species_by_trait_coverage.html">fb_filter_species_by_trait_coverage</a></span><span class="op">(</span></span>
<span>  <span class="va">red_sp_traits</span>, threshold_traits_proportion <span class="op">=</span> <span class="fl">0.5</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">red_sp_traits_2</span><span class="op">)</span></span>
<span><span class="co">#&gt;   species plant_height seed_mass</span></span>
<span><span class="co">#&gt; 1    AALB     49.64162 67.866923</span></span>
<span><span class="co">#&gt; 3    ACEP     25.87500 64.703750</span></span>
<span><span class="co">#&gt; 4    ANEB     15.00000        NA</span></span>
<span><span class="co">#&gt; 5    APIN     27.33333 55.520000</span></span>
<span><span class="co">#&gt; 6    CLIB     35.63636 86.872600</span></span>
<span><span class="co">#&gt; 7    CSEM     24.69231  7.608125</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">red_sp_traits_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 24  3</span></span></code></pre></div>
<p><del>We thus have selected 2 traits that cover at least 75% of the
initial species list and 127 species which have known values for these
two traits.</del></p>
</div>
<div class="section level3">
<h3 id="filter-sites-by-trait-coverage">Filter sites by trait coverage<a class="anchor" aria-label="anchor" href="#filter-sites-by-trait-coverage"></a>
</h3>
<p>Now that we have filtered our traits and species of interest we need
to filter the sites, that contain enough species for which the traits
are available. Similarly to above the function is
<code><a href="../reference/fb_filter_sites_by_trait_coverage.html">fb_filter_sites_by_trait_coverage()</a></code> it takes as two first
arguments the site x species <code>data.frame</code> and the species x
traits <code>data.frame</code>. The third argument is
<code>threshold_traits_proportion</code> that indicates the percent
coverage of traits to filter each site. Note that this coverage is
weighted by the occurrence, abundance, or cover depending on the content
of the site x species <code>data.frame</code>.</p>
<p>Let’s say here we’re interested in sites for which our species with
available traits represent at least 90% of the species present:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Initial site x species data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">woodiv_site_species</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5366   25</span></span>
<span></span>
<span><span class="co"># Filter sites with at least 90% species covered</span></span>
<span><span class="va">filt_sites</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fb_filter_sites_by_trait_coverage.html">fb_filter_sites_by_trait_coverage</a></span><span class="op">(</span></span>
<span>  <span class="va">woodiv_site_species</span>, <span class="va">red_sp_traits_2</span>, threshold_traits_proportion <span class="op">=</span> <span class="fl">0.9</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filtered sites</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">filt_sites</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5364   25</span></span>
<span></span>
<span><span class="va">filt_sites</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="co">#&gt;       site AALB ACEP APIN</span></span>
<span><span class="co">#&gt; 1 41152325    1    0    0</span></span>
<span><span class="co">#&gt; 2 40852325    1    0    0</span></span>
<span><span class="co">#&gt; 3 40852345    1    0    0</span></span>
<span><span class="co">#&gt; 4 42552105    1    0    0</span></span></code></pre></div>
<p><del>The output of the function is a site x species
<code>data.frame</code> with selected sites and species. Now we selected
1,268 sites out of 1,505, for our 2 traits and 127 species.</del></p>
</div>
</div>
<div class="section level2">
<h2 id="computing-functional-diversity-metrics">Computing Functional Diversity metrics<a class="anchor" aria-label="anchor" href="#computing-functional-diversity-metrics"></a>
</h2>
<p>The <code>funbiogeo</code> functions helped us filter our data
appropriately with enough available trait information for species and
sites.</p>
<p>We can use the filtered datasets to proceed with our analyses using
other readily available tools for functional diversity indices. This
where you should use your preferred packages to compute functional
diversity indices like <a href="https://cran.r-project.org/package=fundiversity" class="external-link"><code>fundiversity</code></a>,
<a href="https://cran.r-project.org/package=betapart" class="external-link"><code>betapart</code></a>,
or <a href="https://cran.r-project.org/package=hypervolume" class="external-link"><code>hypervolume</code></a>.</p>
<p>For the sake of the example we included a function in
<code>funbiogeo</code> to compute Community-Weighted Mean <span class="citation">(CWM, Garnier et al. 2004)</span> named
<code><a href="../reference/fb_cwm.html">fb_cwm()</a></code>. The CWM is the abundance-weighted average trait
per site. We’ll be using it in the following section we’ll then show
another example computing functional diversity indices using the
<code>fundiversity</code> package.</p>
<div class="section level3">
<h3 id="community-weighted-mean-cwm">Community-Weighted Mean (CWM)<a class="anchor" aria-label="anchor" href="#community-weighted-mean-cwm"></a>
</h3>
<p>We’re interested to look at the spatial distribution of the average
plant height and seed mass of Rosaceae tree species. To do so, we can
compute the community-weighted mean of both traits. We’ll use the
<code><a href="../reference/fb_cwm.html">fb_cwm()</a></code> function to do so, it takes the site x species
<code>data.frame</code> and species x traits <code>data.frame</code> as
arguments.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Note that we're reusing our filtered data to compute CWM</span></span>
<span><span class="va">cwm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fb_cwm.html">fb_cwm</a></span><span class="op">(</span><span class="va">filt_sites</span>, <span class="va">red_sp_traits_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Some species had NA trait values, removing them from CWM computation</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cwm</span><span class="op">)</span></span>
<span><span class="co">#&gt;       site        trait      cwm</span></span>
<span><span class="co">#&gt; 1 26351755 plant_height 12.31767</span></span>
<span><span class="co">#&gt; 2 26351765 plant_height  4.88150</span></span>
<span><span class="co">#&gt; 3 26351955 plant_height 12.31767</span></span>
<span><span class="co">#&gt; 4 26351965 plant_height 13.77575</span></span>
<span><span class="co">#&gt; 5 26451755 plant_height  4.88150</span></span>
<span><span class="co">#&gt; 6 26451765 plant_height 15.76845</span></span></code></pre></div>
<p>It outputs a <code>data.frame</code> with 3 columns: the first one,
<code>site</code>, shows the site name as provided in the input site x
species <code>data.frame</code>, <code>trait</code> which indicates the
trait name on which the CWM is computed, and <code>cwm</code> which
shows the value of the CWM.</p>
</div>
<div class="section level3">
<h3 id="compute-functional-diversity-indices">Compute functional diversity indices<a class="anchor" aria-label="anchor" href="#compute-functional-diversity-indices"></a>
</h3>
<p>We can also integrate our filtered datasets in other functional
diversity computation pipeline. We’ll show an example by computing
functional richness with <code>fundiversity</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## To install 'fundiversity' uncomment the following line</span></span>
<span><span class="co"># install.packages("fundiversity")</span></span>
<span></span>
<span><span class="co"># Functional richness in 'fundiversity' requires all the traits to be known</span></span>
<span><span class="co"># so we need to filter the traits</span></span>
<span><span class="va">filt_traits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span></span>
<span>  <span class="va">red_sp_traits</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">plant_height</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">seed_mass</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># We need to transform species and site names as row names for species-traits</span></span>
<span><span class="co"># and site-species data.frames, as required by 'fundiversity'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">filt_traits</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">filt_traits</span><span class="op">$</span><span class="va">species</span></span>
<span><span class="va">filt_traits</span> <span class="op">&lt;-</span> <span class="va">filt_traits</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">filt_sites</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">filt_sites</span><span class="op">$</span><span class="va">site</span></span>
<span><span class="va">filt_sites</span> <span class="op">&lt;-</span> <span class="va">filt_sites</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Scale traits</span></span>
<span><span class="va">filt_traits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">filt_traits</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute Functional Richness</span></span>
<span><span class="va">fric</span> <span class="op">&lt;-</span> <span class="fu">fundiversity</span><span class="fu">::</span><span class="fu"><a href="https://funecology.github.io/fundiversity/reference/fd_fric.html" class="external-link">fd_fric</a></span><span class="op">(</span><span class="va">filt_traits</span>, <span class="va">filt_sites</span><span class="op">)</span></span>
<span><span class="co">#&gt; Differing number of species between trait dataset and site-species matrix</span></span>
<span><span class="co">#&gt; Taking subset of species</span></span>
<span><span class="co">#&gt; Warning in fundiversity::fd_fric(filt_traits, filt_sites): Some sites had less</span></span>
<span><span class="co">#&gt; species than traits so returned FRic is 'NA'</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fric</span><span class="op">)</span></span>
<span><span class="co">#&gt;       site     FRic</span></span>
<span><span class="co">#&gt; 1 41152325 1.387675</span></span>
<span><span class="co">#&gt; 2 40852325 1.465982</span></span>
<span><span class="co">#&gt; 3 40852345 1.485531</span></span>
<span><span class="co">#&gt; 4 42552105 1.067421</span></span>
<span><span class="co">#&gt; 5 41152315 1.465982</span></span>
<span><span class="co">#&gt; 6 37452365       NA</span></span></code></pre></div>
<p>We now have a table with Functional Richness computed for all of our
sites.</p>
</div>
</div>
<div class="section level2">
<h2 id="putting-variables-on-the-map">Putting variables on the map<a class="anchor" aria-label="anchor" href="#putting-variables-on-the-map"></a>
</h2>
<div class="section level3">
<h3 id="map-of-environmental-raster">Map of environmental raster<a class="anchor" aria-label="anchor" href="#map-of-environmental-raster"></a>
</h3>
<p>If we want to display the environment associated with our sites of
interest, we can leverage environmental raster layers, like the mean
annual temperature. Fortunately, we have access to an example raster of
mean annual temperature through <code>funbiogeo</code>. The package
provides a helper function display a raster layer easily (without any
assumption about the projection) named <code><a href="../reference/fb_map_raster.html">fb_map_raster()</a></code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read raster</span></span>
<span><span class="va">tavg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>  <span class="st">"extdata"</span>, <span class="st">"annual_mean_temp.tif"</span>, package <span class="op">=</span> <span class="st">"funbiogeo"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">tavg</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">tavg</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Map raster</span></span>
<span><span class="fu"><a href="../reference/fb_map_raster.html">fb_map_raster</a></span><span class="op">(</span><span class="va">tavg</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_distiller</a></span><span class="op">(</span><span class="st">"Temperature"</span>, palette <span class="op">=</span> <span class="st">"Spectral"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Mean annual temperature in Europe"</span><span class="op">)</span></span></code></pre></div>
<p><img src="funbiogeo_files/figure-html/map-tavg-1.png" width="100%"></p>
<p>We can also combine that with the annual precipitation information
available as an example</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://patchwork.data-imaginist.com" class="external-link">"patchwork"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Read raster ------------------------------------------------------------------</span></span>
<span><span class="va">tavg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"annual_mean_temp.tif"</span>, package <span class="op">=</span> <span class="st">"funbiogeo"</span><span class="op">)</span></span>
<span><span class="va">tavg</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">tavg</span><span class="op">)</span></span>
<span></span>
<span><span class="va">prec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"annual_tot_prec.tif"</span>, package <span class="op">=</span> <span class="st">"funbiogeo"</span><span class="op">)</span></span>
<span><span class="va">prec</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">prec</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Individual Maps --------------------------------------------------------------</span></span>
<span><span class="va">map_temperature</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fb_map_raster.html">fb_map_raster</a></span><span class="op">(</span><span class="va">tavg</span>, legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_distiller</a></span><span class="op">(</span><span class="st">"Temperature"</span>, palette <span class="op">=</span> <span class="st">"Spectral"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">map_precipitation</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fb_map_raster.html">fb_map_raster</a></span><span class="op">(</span><span class="va">prec</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_distiller</a></span><span class="op">(</span><span class="st">"Precipitation"</span>, direction <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot composition -------------------------------------------------------------</span></span>
<span></span>
<span><span class="op">(</span><span class="va">map_temperature</span> <span class="op">/</span> <span class="va">map_precipitation</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html" class="external-link">plot_annotation</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Europe"</span>, </span>
<span>                  theme <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"mono"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="funbiogeo_files/figure-html/composition-map-1.png" width="100%"></p>
<p>This function allows the visualization of a raster in a simple
fashion, but it doesn’t tell us anything about the environmental
variable at the sites. In the next section we will follow the example of
mapping an environmental variable.</p>
</div>
<div class="section level3">
<h3 id="map-of-average-environmental-variable-in-site">Map of average environmental variable in site<a class="anchor" aria-label="anchor" href="#map-of-average-environmental-variable-in-site"></a>
</h3>
<p>To get the average environmental variable in the site we can use the
<code><a href="../reference/fb_get_environment.html">fb_get_environment()</a></code> function, it takes as arguments the
site-locations object and an environmental raster from the
<code>terra</code> package. By default, it takes the average of the
raster values per site.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">site_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fb_get_environment.html">fb_get_environment</a></span><span class="op">(</span><span class="va">woodiv_locations</span>, <span class="va">tavg</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">site_mat</span><span class="op">)</span></span>
<span><span class="co">#&gt;       site annual_mean_temp</span></span>
<span><span class="co">#&gt; 1 26351755              NaN</span></span>
<span><span class="co">#&gt; 2 26351765         16.44746</span></span>
<span><span class="co">#&gt; 3 26351955         16.08605</span></span>
<span><span class="co">#&gt; 4 26351965              NaN</span></span>
<span><span class="co">#&gt; 5 26451755         16.66498</span></span>
<span><span class="co">#&gt; 6 26451765         16.39656</span></span></code></pre></div>
<p>The variable names in columns are based on the names of the provided
raster. To put these values on the map we can use the
<code><a href="../reference/fb_map_site_data.html">fb_map_site_data()</a></code> function, which allows mapping arbitrary
site-level variables. It takes three needed arguments: the first of
which, <code>site_locations</code>, which is the <code>sf</code> object
describing sites’ geographic locations; the second argument is
<code>site_data</code>, which is a <code>data.frame</code> giving
additional data indexed by site; and <code>selected_col</code>, which is
a character giving the name of the column to plot from the
<code>site_data</code> argument.</p>
<p>We can thus plot the mean annual temperature of sites through the
following commands:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fb_map_site_data.html">fb_map_site_data</a></span><span class="op">(</span><span class="va">woodiv_locations</span>, <span class="va">site_mat</span>, <span class="st">"annual_mean_temp"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Mean Annual Temperature per Site"</span><span class="op">)</span></span></code></pre></div>
<p><img src="funbiogeo_files/figure-html/map-avg-environment-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="map-of-functional-diversity-indices">Map of functional diversity indices<a class="anchor" aria-label="anchor" href="#map-of-functional-diversity-indices"></a>
</h3>
<p>We can leverage the same functions to map our functional diversity
indices. For example, with the body mass CWM:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">body_mass_cwm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">cwm</span>, <span class="va">trait</span> <span class="op">==</span> <span class="st">"plant_height"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/fb_map_site_data.html">fb_map_site_data</a></span><span class="op">(</span><span class="va">woodiv_locations</span>, <span class="va">body_mass_cwm</span>, <span class="st">"cwm"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span>trans <span class="op">=</span> <span class="st">"log10"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Tree height CWM"</span><span class="op">)</span></span></code></pre></div>
<p><img src="funbiogeo_files/figure-html/map-cwm-body-mass-1.png" width="100%"></p>
<p>We can do similarly for functional richness:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fb_map_site_data.html">fb_map_site_data</a></span><span class="op">(</span><span class="va">woodiv_locations</span>, <span class="va">fric</span>, <span class="st">"FRic"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"magma"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Tree Functional Richness"</span><span class="op">)</span></span></code></pre></div>
<p><img src="funbiogeo_files/figure-html/map-fric-1.png" width="100%"></p>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>This concludes our tutorial to introduce <code>funbiogeo</code>. The
packages contains many more features, especially diagnostic plots, which
are explained in detail in <a href="diagnostic-plots.Rmd">a dedicated
vignette</a>. There is also a specific vignette about <a href="long-format.Rmd">transforming raw data from long to wide
format</a>. Finally, if you’re interested in learning about up-scaling
your sites, you can refer to <a href="upscaling.Rmd">the specific
vignette</a></p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Garnier_Plant_2004" class="csl-entry">
Garnier, Eric, Jacques Cortez, Georges Billès, Marie-Laure Navas,
Catherine Roumet, Max Debussche, Gérard Laurent, et al. 2004.
<span>“Plant <span>Functional Markers Capture Ecosystem Properties
During Secondary Succession</span>.”</span> <em>Ecology</em> 85 (9):
2630–37. <a href="https://doi.org/10.1890/03-0799" class="external-link">https://doi.org/10.1890/03-0799</a>.
</div>
<div id="ref-Monnet_2021" class="csl-entry">
Monnet, Anne-Christine, Kévin Cilleros, Frédéric Médail, Marwan Cheikh
Albassatneh, Juan Arroyo, Gianluigi Bacchetta, Francesca Bagnoli, et al.
2021. <span>“<span class="nocase">WOODIV, a database of occurrences,
functional traits, and phylogenetic data for all Euro-Mediterranean
trees</span>.”</span> <em>Scientific Data</em> 8: 89. <a href="https://doi.org/10.1038/s41597-021-00873-3" class="external-link">https://doi.org/10.1038/s41597-021-00873-3</a>.
</div>
<div id="ref-Violle_emergence_2014" class="csl-entry">
Violle, Cyrille, Peter B. Reich, Stephen W. Pacala, Brian J. Enquist,
and Jens Kattge. 2014. <span>“The Emergence and Promise of Functional
Biogeography.”</span> <em>Proceedings of the National Academy of
Sciences</em> 111 (38): 13690–96. <a href="https://doi.org/10.1073/pnas.1415442111" class="external-link">https://doi.org/10.1073/pnas.1415442111</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nicolas Casajus, Matthias Grenié.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
